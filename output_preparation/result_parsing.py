import numpy as np
import pandas as pd

"""
    The script converts the result data in .npy format to .xlsx format for user-friendly format.
    Results have the following labels:
        - Data name (Data). The data participated in experiment is presented in main.py in data_sets()
        - Distances between clustering (Distances). The considered distance functions is described in main.py in distances_f()
        - Clustering algorithm (Clustering_alg). Used clustering algorithm in experiment, all algorithms are in main.py in clust_alg()
        - Error level (Error). The level of noises (% from meand by component) to be generated from uniform distribution
        - Criterion (Criteria). The stability criterion name
        - Cluster number (k).
        - Stability level (stab_lvl). The estimated stability value
        
    Result file will be saved to results folder with name output.xlsx
    For correct work of this script, in the file ../results/result.npy should be saved. This file is generated by main.py
"""
results = np.load('../results/result.npy')[()]

# indices = np.load('../results/indices.npy')[()]

converted_results = dict()
save_data_to_xlsx = []
for key, item in results.items():

    new_key = tuple(key[i] for i in [0, 1, 3, 4, 5])
    list_init = list(new_key)
    list_init.append(key[2])
    list_init.append(item)

    save_data_to_xlsx.append(list_init)
    converted_results.setdefault(new_key, []).append((key[2], item))

pd_data_to_output = pd.DataFrame(save_data_to_xlsx, columns=['Data', 'Distance', 'Clustering_alg', 'Error', 'Criteria', 'k', 'stab_lvl'])
pd_data_to_output.to_excel('../results/output.xlsx')


for key, item in converted_results.items():
    converted_results[key] = np.array(item)






